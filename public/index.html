<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>MirrorMyTV - Screen Mirroring</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
    }
    
    .video-container {
      position: relative;
      background: #000;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }
    
    #videoPlayer {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    #noStream {
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
    }
    
    /* Android TV optimizations */
    .android-tv .video-container {
      min-height: 60vh;
    }
    
    .android-tv #videoPlayer {
      min-height: 60vh;
    }
    
    /* Tablet optimizations */
    .tablet .video-container {
      min-height: 50vh;
    }
    
    /* Phone optimizations */
    .phone .video-container {
      min-height: 40vh;
    }
    
    /* Ensure video controls are visible on all devices */
    #videoPlayer::-webkit-media-controls-panel {
      background: rgba(0, 0, 0, 0.7);
    }
    
    .video-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      opacity: 0.1;
      pointer-events: none;
    }
    
    .status-indicator {
      position: relative;
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    .status-indicator.active {
      background: #10b981;
      box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
    }
    
    .status-indicator.inactive {
      background: #ef4444;
      animation: none;
    }
    
    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
      }
      70% {
        box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
      }
    }
    
    .window-list-item {
      transition: all 0.2s ease;
    }
    
    .window-list-item:hover {
      transform: translateX(4px);
    }
    
    .window-list-item.selected {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
    }
    
    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-danger {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      transition: all 0.3s ease;
    }
    
    .btn-danger:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(245, 87, 108, 0.4);
    }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen">
  <div class="container mx-auto px-4 py-8 max-w-7xl">
    <!-- Header -->
    <div class="text-center mb-8">
      <div class="flex items-center justify-center gap-4 mb-2">
        <h1 class="text-5xl font-bold text-white">üì∫ MirrorMyTV</h1>
        <a href="/admin.html" class="bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg transition-colors text-sm font-semibold">
          ‚öôÔ∏è Admin
        </a>
      </div>
      <p class="text-purple-200 text-lg">High-Quality Screen Mirroring for Your Local Network</p>
      <p id="clientIdDisplay" class="text-purple-300 text-sm mt-2">Client: Connecting...</p>
    </div>

    <!-- Status Card -->
    <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6 border border-white/20">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div id="statusIndicator" class="status-indicator inactive"></div>
          <div>
            <h3 class="text-white font-semibold text-lg">Stream Status</h3>
            <p id="statusText" class="text-purple-200 text-sm">Inactive</p>
          </div>
        </div>
        <div class="text-right">
          <p class="text-purple-200 text-sm">Quality: Full HD</p>
          <p class="text-purple-200 text-sm">30 FPS ‚Ä¢ 8Mbps ‚Ä¢ GPU</p>
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Control Panel -->
      <div class="lg:col-span-1 space-y-6">
        <!-- Window Selection -->
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
          <h2 class="text-white font-semibold text-xl mb-4">Select Window</h2>
          <div class="space-y-3 mb-4">
            <button id="refreshWindows" class="w-full bg-white/10 hover:bg-white/20 text-white py-2 px-4 rounded-lg transition-colors">
              üîÑ Refresh Windows
            </button>
          </div>
          <div id="windowList" class="space-y-2 max-h-96 overflow-y-auto">
            <p class="text-purple-200 text-center py-8">Click "Refresh Windows" to load</p>
          </div>
        </div>

        <!-- Controls -->
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
          <h2 class="text-white font-semibold text-xl mb-4">Controls</h2>
          <div class="space-y-3">
            <button id="startStream" class="btn-primary w-full text-white py-3 px-6 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed">
              ‚ñ∂Ô∏è Start Streaming
            </button>
            <button id="stopStream" class="btn-danger w-full text-white py-3 px-6 rounded-lg font-semibold disabled:opacity-50 disabled:cursor-not-allowed">
              ‚èπÔ∏è Stop Streaming
            </button>
          </div>
        </div>

        <!-- Admin Panel -->
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
          <h2 class="text-white font-semibold text-xl mb-4">‚öôÔ∏è Server Admin</h2>
          <div class="space-y-3">
            <div class="flex items-center justify-between text-sm">
              <span class="text-purple-200">Active Streams:</span>
              <span id="activeStreamsCount" class="text-white font-semibold">0</span>
            </div>
            <button id="refreshStreams" class="w-full bg-white/10 hover:bg-white/20 text-white py-2 px-4 rounded-lg transition-colors text-sm">
              üîÑ Refresh Streams
            </button>
            <button id="stopAllStreams" class="w-full bg-red-500/20 hover:bg-red-500/30 text-white py-2 px-4 rounded-lg transition-colors text-sm">
              ‚èπÔ∏è Stop All Streams
            </button>
          </div>
          <div id="streamsList" class="mt-4 space-y-2 max-h-48 overflow-y-auto"></div>
        </div>
      </div>

      <!-- Video Player -->
      <div class="lg:col-span-2">
        <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 border border-white/20">
          <h2 class="text-white font-semibold text-xl mb-4">Live Stream</h2>
          <div class="video-container aspect-video">
            <video id="videoPlayer" class="w-full h-full" controls autoplay muted>
              <source id="videoSource" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <div id="noStream" class="absolute inset-0 flex items-center justify-center text-white">
              <div class="text-center">
                <div class="text-6xl mb-4">üì∫</div>
                <p class="text-xl font-semibold">No Active Stream</p>
                <p class="text-purple-200 mt-2">Select a window and click "Start Streaming"</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>

